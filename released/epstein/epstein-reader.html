<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Released Files ‚Ä¢ Epstein Files | Civic Threat</title>
  <meta name="description" content="Listen to released court PDFs with text-to-speech, page-by-page controls, and a built-in viewer. For adults 21+ only." />
  <meta name="robots" content="index,follow" />
  <meta property="og:title" content="Epstein Files ‚Ä¢ Civic Threat" />
  <meta property="og:description" content="Listen to released court PDFs with page-by-page TTS and a built-in viewer. Adults 21+ only." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://civicthreat.us/released/epstein/epstein-reader.html" />
  <meta property="og:image" content="https://civicthreat.us/assets/civicthreat-social-1200x630.jpg" />
  <link rel="icon" href="/assets/logo.png" />
  <link rel="stylesheet" href="/styles.css" />

  <style>
    .page-wrap{ max-width: 1120px; margin: 0 auto; padding: 22px 16px 42px; }
    .hero{ padding: 18px 0 10px; }
    .hero h1{ margin: 0 0 6px; font-size: clamp(26px, 4vw, 38px); letter-spacing:.02em; }
    .hero p{ margin: 0; opacity: .9; line-height: 1.5; }

    /* Square containers (match rest of site) */
    .ep-box{ border-radius: 0 !important; }
    .ep-grid{ display:grid; grid-template-columns: 1.15fr .85fr; gap: 16px; margin-top: 16px; }
    @media (max-width: 980px){ .ep-grid{ grid-template-columns: 1fr; } }

    .ep-panel{ border: 1px solid rgba(255,255,255,.12); background: rgba(0,0,0,.25); }
    .ep-panel .pad{ padding: 14px; }

    .ep-label{ font-size: 12px; opacity: .85; margin: 0 0 6px; }
    .ep-row{ display:flex; gap:12px; flex-wrap: wrap; align-items: end; }
    .ep-row > .field{ flex: 1 1 240px; min-width: 220px; }
    .ep-row > .field.small{ flex: 0 0 180px; min-width: 160px; }

    select{
      width: 100%;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
      color: #fff;
      outline: none;
      border-radius: 0;
    }

    .ep-controls{ display:flex; gap:10px; flex-wrap: wrap; margin-top: 12px; }
    .ep-controls .btn{ border-radius: 0 !important; }

    .ep-status{
      margin-top: 12px;
      padding: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
      border-radius: 0;
      min-height: 54px;
    }
    .ep-status strong{ display:block; margin-bottom: 4px; }
    .ep-status .big{ font-size: 16px; font-weight: 900; letter-spacing:.02em; }

    .viewer-wrap{ display:flex; flex-direction: column; gap: 10px; }
    .viewer-top{ display:flex; justify-content: space-between; align-items: center; gap: 10px; }
    .viewer-top .meta{ font-size: 12px; opacity: .85; }
    .viewer-canvas{
      width: 100%;
      background: #000;
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 0;
      min-height: 420px;
      display:block;
    }

    /* Disclosure */
    .legal{
      margin-top: 12px;
      font-size: 12px;
      opacity: .82;
      line-height: 1.5;
    }

    /* FULL-WIDTH GALLERY SECTION (separate section under player+viewer) */
    .gallery-section{
      margin-top: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
    }
    .gallery-section .pad{ padding: 14px; }
    .gallery-section h2{
      margin: 0 0 10px;
      font-size: 16px;
      letter-spacing: .02em;
    }
    .gallery-grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }
    @media (max-width: 980px){
      .gallery-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 700px){
      .gallery-grid{ grid-template-columns: 1fr; }
    }
    .g-card{
      margin: 0;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      overflow: hidden;
    }
    .g-card img{
      width: 100%;
      height: auto;
      display:block;
      background:#000;
    }
    .g-cap{
      padding: 8px 10px;
      font-size: 12px;
      opacity: .85;
      line-height: 1.35;
    }
    .g-cap .src{
      margin-top: 6px;
      opacity: .75;
      font-size: 11px;
    }

    /* Viewer pop-out modal */
    .viewer-modal{
      position: fixed;
      inset: 0;
      z-index: 9998;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,.82);
      padding: 18px;
    }
    .viewer-modal.open{ display:flex; }
    .viewer-modal .card{
      width: min(1080px, 96vw);
      max-height: 92vh;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10,10,10,.94);
      border-radius: 0;
      box-shadow: 0 20px 60px rgba(0,0,0,.6);
      display:flex;
      flex-direction: column;
    }
    .viewer-modal .head{
      padding: 12px 12px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      display:flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .viewer-modal .head strong{ letter-spacing:.02em; }
    .viewer-modal .body{
      padding: 12px;
      overflow: auto;
    }
    .viewer-modal canvas{
      width: 100%;
      height: auto;
      display:block;
      background:#000;
      border: 1px solid rgba(255,255,255,.12);
    }

    /* 21+ gate */
    .gate{
      position: fixed; inset: 0; z-index: 9999;
      background: rgba(0,0,0,.78);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
    }
    .gate .card{
      width: min(720px, 100%);
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10,10,10,.92);
      border-radius: 0;
      padding: 18px;
      box-shadow: 0 20px 60px rgba(0,0,0,.6);
    }
    .gate h2{ margin: 0 0 10px; font-size: 22px; }
    .gate p{ margin: 0 0 10px; opacity: .9; line-height: 1.55; }
    .gate .row{ display:flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 12px; }
    .gate label{ display:flex; gap:10px; align-items:center; cursor:pointer; }
    .gate input[type="checkbox"]{ width: 18px; height: 18px; }
    .gate .actions{ display:flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; margin-top: 14px; }
    .gate .btn{ border-radius: 0 !important; }
    .gate .legal{ margin-top: 10px; font-size: 12px; opacity: .8; line-height: 1.45; }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z03YK1FYXW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z03YK1FYXW');
  </script>
</head>

<body>
  <!-- Header injected by app.js -->
  <div id="siteHeader"></div>

  <main class="page-wrap">
    <header class="hero">
      <h1>Released Files ‚Ä¢ Epstein Files</h1>
      <p>Pick a PDF, choose a voice and speed, then press Play. Use Prev/Next to move one page at a time.</p>
    </header>

    <!-- PLAYER + VIEWER (TOP AREA) -->
    <section class="ep-grid">
      <!-- LEFT: Player -->
      <div class="ep-panel ep-box">
        <div class="pad">
          <div class="ep-row">
            <div class="field">
              <div class="ep-label">Choose a PDF</div>
              <select id="pdfSelect" aria-label="Choose a PDF">
                <option value="">Loading PDFs‚Ä¶</option>
              </select>
            </div>
            <div class="field">
              <div class="ep-label">Voice</div>
              <select id="voiceSelect" aria-label="Choose a voice">
                <option value="">Loading voices‚Ä¶</option>
              </select>
            </div>
            <div class="field small">
              <div class="ep-label">Speed</div>
              <select id="speedSelect" aria-label="Choose reading speed">
                <option value="1">1.0√ó</option>
                <option value="1.25">1.25√ó</option>
                <option value="1.5">1.5√ó</option>
                <option value="2">2.0√ó</option>
              </select>
            </div>
          </div>

          <div class="ep-controls" role="group" aria-label="Playback controls">
            <button class="btn blue" id="btnPlay" type="button">‚ñ∂ Play</button>
            <button class="btn" id="btnPause" type="button">‚è∏ Pause</button>
            <button class="btn" id="btnStop" type="button">‚èπ Stop</button>
            <button class="btn" id="btnPrev" type="button">‚Üê Prev Page</button>
            <button class="btn" id="btnNext" type="button">Next Page ‚Üí</button>
            <button class="btn" id="btnMute" type="button">üîá Mute</button>

            <button class="btn" id="btnAutoRead" type="button" aria-pressed="false" title="Automatically advance to the next PDF when finished">‚è≠ Auto-Read: Off</button>
            <button class="btn" id="btnLoop" type="button" aria-pressed="false" title="Loops current PDF (unless Auto-Read is on, then loops all PDFs)">üîÅ Loop: Off</button>
          </div>

          <div class="ep-status ep-box" id="statusBox" aria-live="polite">
            <strong class="big" id="statusTitle">Ready.</strong>
            <div id="statusLine">Select a PDF to begin.</div>
          </div>

          <div class="legal">
            <strong>Disclosure:</strong> This page provides text-to-speech playback and viewing of publicly released documents.
            Content may be explicit, disturbing, or contain allegations. Civic Threat does not endorse wrongdoing and does not make claims about guilt or innocence.
            This tool is provided for accessibility, public-interest review, and discussion. For full context, consult the complete PDF and primary sources.
          </div>
        </div>
      </div>

      <!-- RIGHT: Viewer -->
      <div class="ep-panel ep-box">
        <div class="pad viewer-wrap">
          <div class="viewer-top">
            <div><strong>Viewer</strong></div>
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="meta" id="pageMeta">No PDF loaded.</div>
              <button class="btn" id="btnPopViewer" type="button" title="Pop out a larger viewer">üîç Pop-out</button>
            </div>
          </div>
          <canvas id="pdfCanvas" class="viewer-canvas" width="1000" height="1400"></canvas>
        </div>
      </div>
    </section>

    <!-- FULL-WIDTH IMAGES SECTION (UNDER THE PLAYER+VIEWER) -->
    <section class="gallery-section ep-box" aria-label="Released images">
      <div class="pad">
        <h2>Released Image Excerpts</h2>
        <div id="galleryGrid" class="gallery-grid">
          <div style="opacity:.8;font-size:13px;">Loading images‚Ä¶</div>
        </div>

        <div class="legal" style="margin-top:12px">
          <strong>Image note:</strong> These images are displayed for reference alongside the released PDFs. If you need full context, use the PDF reader above and consult the complete file.
        </div>
      </div>
    </section>
  </main>

  <!-- Viewer pop-out modal -->
  <div class="viewer-modal" id="viewerModal" role="dialog" aria-modal="true" aria-label="Pop-out PDF viewer">
    <div class="card ep-box">
      <div class="head">
        <div>
          <strong>PDF Viewer</strong>
          <span class="meta" id="viewerModalMeta" style="margin-left:10px; opacity:.85; font-size:12px;"></span>
        </div>
        <div style="display:flex; gap:10px;">
          <button class="btn" id="btnViewerClose" type="button">‚úï Close</button>
        </div>
      </div>
      <div class="body">
        <canvas id="pdfCanvasBig" width="1600" height="2200"></canvas>
      </div>
    </div>
  </div>

  <!-- 21+ gate -->
  <div class="gate" id="ageGate" role="dialog" aria-modal="true" aria-labelledby="gateTitle">
    <div class="card ep-box">
      <h2 id="gateTitle">Adults 21+ Only</h2>
      <p>This section may contain sexually explicit descriptions. You must confirm you are twenty-one (21) or older to view and use the reader.</p>
      <div class="row">
        <label for="gateCheck">
          <input id="gateCheck" type="checkbox" />
          <span>I confirm that I am 21 or older.</span>
        </label>
      </div>
      <div class="actions">
        <button class="btn" id="gateLeave" type="button">Leave</button>
        <button class="btn blue" id="gateEnter" type="button" disabled>Continue</button>
      </div>
      <div class="legal">
        By continuing, you agree you are 21+ and understand the content may be explicit.
      </div>
    </div>
  </div>

  <!-- PDF.js -->
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js" crossorigin="anonymous"></script>
  <script>
    if(window.pdfjsLib){
      window.pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js";
    }
    (function(){
      function qs(sel, root=document){ return root.querySelector(sel); }
      function qsa(sel, root=document){ return root ? Array.from(root.querySelectorAll(sel)) : []; }
      function wireDropdown(dd){
        if(!dd) return;
        const btn = qs("button", dd);
        const menu = qs(".dropdown-menu", dd);
        if(!btn || !menu) return;
        function close(){ dd.classList.remove("open"); btn.setAttribute("aria-expanded","false"); }
        function open(){ dd.classList.add("open"); btn.setAttribute("aria-expanded","true"); }
        btn.addEventListener("click",(e)=>{ e.preventDefault(); dd.classList.contains("open") ? close() : open(); });
        document.addEventListener("click",(e)=>{ if(!dd.contains(e.target)) close(); });
        document.addEventListener("keydown",(e)=>{ if(e.key==="Escape") close(); });
        qsa("a", menu).forEach(a=>a.addEventListener("click", close));
      }
      wireDropdown(qs("#platformsDD"));
      wireDropdown(qs("#releasedDD"));
    })();
  </script>

  <script src="./epstein-tts.js?v=14"></script>

  <!-- Voice Fix Shim (FB in-app browser / Android WebView) -->
  <script>
  /**
   * Voice Fix Shim (FB in-app browser / Android WebView)
   * - Retries speechSynthesis voices
   * - Forces voice init on user gesture (Play click)
   * - Shows "Open in Chrome" help if voices never load
   */
  (function () {
    const voiceSelect = document.getElementById("voiceSelect");
    const btnPlay = document.getElementById("btnPlay");
    const statusTitle = document.getElementById("statusTitle");
    const statusLine  = document.getElementById("statusLine");

    if (!voiceSelect || !("speechSynthesis" in window)) return;

    // Detect FB/IG in-app browsers (common voice failure)
    const ua = navigator.userAgent || "";
    const isInApp = /FBAN|FBAV|Instagram/i.test(ua);

    // Add help message box once
    function ensureHelpBox() {
      if (document.getElementById("voiceHelpBox")) return;
      const box = document.createElement("div");
      box.id = "voiceHelpBox";
      box.style.cssText =
        "margin-top:10px;padding:10px;border:1px solid rgba(255,255,255,.12);" +
        "background:rgba(0,0,0,.35);font-size:12px;line-height:1.5;display:none;";
      box.innerHTML =
        "<strong>Voice not loading?</strong><br>" +
        "Facebook‚Äôs in-app browser sometimes blocks or hides text-to-speech voices.<br>" +
        "Tap the ‚ãÆ menu and choose <b>Open in browser</b> (Chrome).";
      // place under the controls/status area
      const statusBox = document.getElementById("statusBox");
      if (statusBox && statusBox.parentNode) statusBox.parentNode.insertBefore(box, statusBox.nextSibling);
    }

    function setStatus(msg) {
      if (statusTitle) statusTitle.textContent = msg;
      if (statusLine)  statusLine.textContent  = isInApp
        ? "If voices don‚Äôt appear, open this page in Chrome from the ‚ãÆ menu."
        : "If voices don‚Äôt appear, try Chrome or another browser.";
    }

    function clearSelect() {
      voiceSelect.innerHTML = "";
    }

    function addOption(label, value) {
      const opt = document.createElement("option");
      opt.textContent = label;
      opt.value = value;
      voiceSelect.appendChild(opt);
    }

    function renderVoices(voices) {
      clearSelect();

      // Put a safe default option first
      addOption("Default device voice", "");

      // Keep list broad; some environments return only a few
      const list = voices
        .slice()
        .sort((a, b) => (a.lang || "").localeCompare(b.lang || "") || (a.name || "").localeCompare(b.name || ""));

      for (const v of list) {
        const label = `${v.name} (${v.lang || "?"})`;
        addOption(label, v.name);
      }

      // Try to auto-select a UK English voice if present
      const preferred =
        list.find(v => /en-GB/i.test(v.lang) && /Google|UK|British/i.test(v.name)) ||
        list.find(v => /en-GB/i.test(v.lang)) ||
        list.find(v => /en/i.test(v.lang));

      if (preferred) voiceSelect.value = preferred.name;

      setStatus("Voices loaded.");
      const help = document.getElementById("voiceHelpBox");
      if (help) help.style.display = "none";
    }

    let done = false;

    function loadVoicesWithRetry(retries = 20) {
      if (done) return;
      const voices = window.speechSynthesis.getVoices ? window.speechSynthesis.getVoices() : [];
      if (voices && voices.length) {
        done = true;
        renderVoices(voices);
        return;
      }
      if (retries <= 0) {
        ensureHelpBox();
        const help = document.getElementById("voiceHelpBox");
        if (help) help.style.display = isInApp ? "block" : "none";
        clearSelect();
        addOption("No voices available in this browser", "");
        setStatus("No voices found.");
        return;
      }
      setTimeout(() => loadVoicesWithRetry(retries - 1), 250);
    }

    // Kick off and also listen for voice events
    window.speechSynthesis.onvoiceschanged = () => loadVoicesWithRetry(20);
    setTimeout(() => loadVoicesWithRetry(20), 0);

    // User-gesture unlock: re-run when Play is tapped
    if (btnPlay) {
      btnPlay.addEventListener("click", () => {
        loadVoicesWithRetry(20);
      }, { passive: true });
    }
  })();
  </script>

  <!-- Auto-Read / Loop / Viewer pop-out logic -->
  <script>
    (function(){
      function qs(sel, root=document){ return root.querySelector(sel); }
      function safeClick(btn){ try{ btn && btn.click(); }catch(e){} }

      const pdfSelect = qs("#pdfSelect");
      const btnPlay = qs("#btnPlay");
      const btnStop = qs("#btnStop");

      const statusTitle = qs("#statusTitle");
      const statusLine  = qs("#statusLine");

      const btnAutoRead = qs("#btnAutoRead");
      const btnLoop     = qs("#btnLoop");

      const pageMeta = qs("#pageMeta");

      // Viewer popout
      const btnPopViewer = qs("#btnPopViewer");
      const viewerModal = qs("#viewerModal");
      const btnViewerClose = qs("#btnViewerClose");
      const viewerModalMeta = qs("#viewerModalMeta");
      const canvasSmall = qs("#pdfCanvas");
      const canvasBig = qs("#pdfCanvasBig");
      const bigCtx = canvasBig && canvasBig.getContext ? canvasBig.getContext("2d") : null;

      // Toggles (persist)
      const LS_AUTO = "ep_reader_autoRead";
      const LS_LOOP = "ep_reader_loop";

      let autoRead = localStorage.getItem(LS_AUTO) === "1";
      let loopOn   = localStorage.getItem(LS_LOOP) === "1";

      function setBtnState(btn, on, labelOn, labelOff){
        if(!btn) return;
        btn.setAttribute("aria-pressed", on ? "true" : "false");
        btn.textContent = on ? labelOn : labelOff;
      }
      function syncButtons(){
        setBtnState(btnAutoRead, autoRead, "‚è≠ Auto-Read: On", "‚è≠ Auto-Read: Off");
        setBtnState(btnLoop, loopOn, "üîÅ Loop: On", "üîÅ Loop: Off");
      }
      syncButtons();

      if(btnAutoRead){
        btnAutoRead.addEventListener("click", function(){
          autoRead = !autoRead;
          localStorage.setItem(LS_AUTO, autoRead ? "1" : "0");
          syncButtons();
        });
      }
      if(btnLoop){
        btnLoop.addEventListener("click", function(){
          loopOn = !loopOn;
          localStorage.setItem(LS_LOOP, loopOn ? "1" : "0");
          syncButtons();
        });
      }

      // Detect finished by watching status text (works without touching epstein-tts.js)
      const DONE_RE = /(finished|complete|completed|done|end of|no more pages|reached the end|final page)/i;

      let lastDoneAt = 0;
      function isDoneText(){
        const t = (statusTitle && statusTitle.textContent || "") + " " + (statusLine && statusLine.textContent || "");
        return DONE_RE.test(t);
      }

      function getPdfOptions(){
        if(!pdfSelect) return [];
        return Array.from(pdfSelect.options || []).filter(o => o && o.value);
      }

      function advanceToNextPdf(loopAll){
        const opts = getPdfOptions();
        if(!opts.length) return false;

        const cur = pdfSelect.value;
        let idx = opts.findIndex(o => o.value === cur);
        if(idx < 0) idx = 0;

        let nextIdx = idx + 1;
        if(nextIdx >= opts.length){
          if(loopAll) nextIdx = 0;
          else return false;
        }

        pdfSelect.value = opts[nextIdx].value;
        pdfSelect.dispatchEvent(new Event("change", { bubbles: true }));

        setTimeout(function(){ safeClick(btnPlay); }, 600);
        return true;
      }

      function restartSamePdf(){
        if(!pdfSelect) return;
        safeClick(btnStop);
        const v = pdfSelect.value;
        setTimeout(function(){
          pdfSelect.value = v;
          pdfSelect.dispatchEvent(new Event("change", { bubbles: true }));
          setTimeout(function(){ safeClick(btnPlay); }, 600);
        }, 250);
      }

      function tick(){
        if(isDoneText()){
          const now = Date.now();
          if(now - lastDoneAt > 2500){
            lastDoneAt = now;

            if(autoRead){
              const ok = advanceToNextPdf(loopOn);
              if(!ok) safeClick(btnStop);
            }else if(loopOn){
              restartSamePdf();
            }
          }
        }
        setTimeout(tick, 700);
      }
      setTimeout(tick, 900);

      // Pop-out viewer
      function openViewer(){
        if(!viewerModal) return;
        viewerModal.classList.add("open");
        if(viewerModalMeta && pageMeta) viewerModalMeta.textContent = pageMeta.textContent || "";
        drawBigOnce();
      }
      function closeViewer(){
        if(!viewerModal) return;
        viewerModal.classList.remove("open");
      }
      function drawBigOnce(){
        if(!canvasSmall || !canvasBig || !bigCtx) return;
        try{
          bigCtx.clearRect(0,0,canvasBig.width, canvasBig.height);
          bigCtx.drawImage(canvasSmall, 0, 0, canvasBig.width, canvasBig.height);
        }catch(e){}
      }

      if(btnPopViewer) btnPopViewer.addEventListener("click", openViewer);
      if(btnViewerClose) btnViewerClose.addEventListener("click", closeViewer);

      if(viewerModal){
        viewerModal.addEventListener("click", function(e){
          if(e.target === viewerModal) closeViewer();
        });
        document.addEventListener("keydown", function(e){
          if(e.key === "Escape" && viewerModal.classList.contains("open")) closeViewer();
        });
      }

      setInterval(function(){
        if(viewerModal && viewerModal.classList.contains("open")){
          if(viewerModalMeta && pageMeta) viewerModalMeta.textContent = pageMeta.textContent || "";
          drawBigOnce();
        }
      }, 500);
    })();
  </script>

  <!-- Gallery loader: loads from ./images.json -->
  <script>
    (function(){
      const grid = document.getElementById("galleryGrid");
      if(!grid) return;

      function esc(s){
        return String(s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
      }

      function card(img){
        const caption = img.caption ? esc(img.caption) : "";
        const source = img.source ? esc(img.source) : "";
        const alt = img.alt ? esc(img.alt) : "Document image excerpt.";
        const src = img.src ? String(img.src) : "";

        const fig = document.createElement("figure");
        fig.className = "g-card ep-box";
        fig.innerHTML = `
          <img src="${esc(src)}" alt="${alt}" loading="lazy" decoding="async">
          <figcaption class="g-cap">
            ${caption ? `<div>${caption}</div>` : ``}
            ${source ? `<div class="src"><strong>Source:</strong> ${source}</div>` : ``}
          </figcaption>
        `;
        return fig;
      }

      fetch("./images.json?v=" + Date.now(), { cache: "no-store" })
        .then(r => {
          if(!r.ok) throw new Error("HTTP " + r.status);
          return r.json();
        })
        .then(data => {
          const list = Array.isArray(data.images) ? data.images : [];
          grid.innerHTML = "";
          if(!list.length){
            grid.innerHTML = `<div style="opacity:.8;font-size:13px;">No images available.</div>`;
            return;
          }
          list.forEach(img => {
            if(!img || !img.src) return;
            grid.appendChild(card(img));
          });
        })
        .catch(() => {
          grid.innerHTML = `<div style="opacity:.85;font-size:13px;line-height:1.5;">Images unavailable right now.</div>`;
        });
    })();
  </script>

  <script src="/app.js?v=2"></script>
</body>
</html>
