<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Civic Threat — PDF Read Aloud</title>

  <style>
    :root{
      --red:#d10f1a;
      --bg:#0b0b0e;
      --card:#14141a;
      --text:#f2f2f5;
      --muted:#b8b8c4;
      --line:rgba(255,255,255,.12);
      --btn:#22222c;
    }
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--text); }
    header{
      position:sticky; top:0; z-index:10;
      background:var(--red); color:white;
      padding:12px 16px; font-weight:800; letter-spacing:.2px;
    }
    main{ max-width:980px; margin:0 auto; padding:18px 16px 40px; }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
      margin:12px 0;
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    label{ color:var(--muted); font-size:13px; }
    select, input[type="range"]{
      background:#0f0f14; color:var(--text);
      border:1px solid var(--line);
      border-radius:10px; padding:10px 12px;
      min-width:260px;
    }
    button{
      background:var(--btn); color:var(--text);
      border:1px solid var(--line);
      border-radius:12px; padding:10px 12px;
      cursor:pointer; font-weight:700;
    }
    button:disabled{ opacity:.45; cursor:not-allowed; }
    .status{ color:var(--muted); font-size:14px; line-height:1.35; }
    .mono{ font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; }
    .progress{
      height:10px; background:#0f0f14; border:1px solid var(--line);
      border-radius:999px; overflow:hidden;
    }
    .bar{ height:100%; width:0%; background:var(--red); transition:width .2s ease; }
    .small{ font-size:12px; color:var(--muted); }
    .warn{ color:#ffcc66; }
  </style>

  <!-- PDF.js (CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.10.38/pdf.min.js"></script>
</head>

<body>
  <header>Civic Threat — PDF Read Aloud</header>

  <main>
    <div class="card">
      <div class="status">
        Select a PDF and press <b>Load & Read</b>. This uses your browser’s speech voices.
        Best results: Chrome desktop (often includes <span class="mono">Google UK English Female</span>).
      </div>
      <div class="small warn" style="margin-top:8px;">
        Note: If a PDF is scanned images (no text layer), it may read nothing unless OCR is done.
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div style="flex:1; min-width:260px;">
          <label for="pdfSelect">Choose PDF</label><br/>
          <select id="pdfSelect"></select>
        </div>

        <div style="flex:1; min-width:260px;">
          <label for="voiceSelect">Voice (optional override)</label><br/>
          <select id="voiceSelect">
            <option value="">Auto: Google UK female → en-GB → fallback</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:12px;">
        <button id="btnLoadRead">Load & Read</button>
        <button id="btnPause" disabled>Pause</button>
        <button id="btnResume" disabled>Resume</button>
        <button id="btnStop" disabled>Stop</button>
      </div>

      <div class="row" style="margin-top:12px;">
        <div style="min-width:220px;">
          <label for="rate">Rate: <span id="rateVal" class="mono">1.0</span></label><br/>
          <input id="rate" type="range" min="0.7" max="1.3" value="1.0" step="0.05"/>
        </div>
        <div style="min-width:220px;">
          <label for="pitch">Pitch: <span id="pitchVal" class="mono">1.0</span></label><br/>
          <input id="pitch" type="range" min="0.8" max="1.2" value="1.0" step="0.05"/>
        </div>
        <div style="min-width:220px;">
          <label for="volume">Volume: <span id="volumeVal" class="mono">1.0</span></label><br/>
          <input id="volume" type="range" min="0.1" max="1.0" value="1.0" step="0.05"/>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="status" id="statusText">Status: idle</div>
      <div class="progress" style="margin-top:10px;">
        <div class="bar" id="progressBar"></div>
      </div>
      <div class="small" id="pageText" style="margin-top:8px;"></div>
    </div>
  </main>

  <script src="./reader.js"></script>
</body> 
</html>
