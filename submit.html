<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="color-scheme" content="dark"/>

  <title>Submit a Facebook Post | Civic Threat</title>
  <meta name="description" content="Submit a Facebook post to Civic Threat for review and archiving. Choose Support or MAGA/Debate, add a headline, then paste an embed iframe or direct URL."/>
  <meta name="robots" content="index,follow"/>

  <!-- Canonical (best once you move to /submit/index.html) -->
  <link rel="canonical" href="https://civicthreat.us/submit"/>

  <!-- Open Graph -->
  <meta property="og:title" content="Submit a Facebook Post | Civic Threat"/>
  <meta property="og:description" content="Submit a Facebook post for review and archiving. Choose Support or MAGA/Debate, add a headline, then paste an embed iframe or direct URL."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://civicthreat.us/submit"/>
  <meta property="og:image" content="https://civicthreat.us/assets/civicthreat-social-1200x630.jpg"/>

  <!-- Twitter/X -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Submit a Facebook Post | Civic Threat"/>
  <meta name="twitter:description" content="Submit a Facebook post for review and archiving. Choose Support or MAGA/Debate, add a headline, then paste an embed iframe or direct URL."/>
  <meta name="twitter:image" content="https://civicthreat.us/assets/civicthreat-social-1200x630.jpg"/>

  <link rel="icon" href="/assets/logo.png"/>
  <link rel="stylesheet" href="/styles.css"/>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z03YK1FYXW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z03YK1FYXW');
  </script>

  <style>
    /* --- Form base (keep your current look) --- */
    label{display:block;font-size:12px;color:rgba(233,238,248,.78);margin:0 0 6px}
    input,select,textarea{
      width:100%;
      border-radius:0;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      color:#e9eef8;
      padding:10px 12px;
      outline:none;
      font-size:14px;
    }
    textarea{min-height:160px;resize:vertical}
    input:focus,select:focus,textarea:focus{border-color:rgba(43,108,255,.75)}
    .smallnote{font-size:12px;color:rgba(233,238,248,.72);line-height:1.45}
    .smallnote a{color:#e9eef8;opacity:.9}
    .smallnote a:hover{text-decoration:underline}
    .hr{height:1px;background:rgba(255,255,255,.08);margin:18px 0}
    .consentBox{
      display:flex;align-items:flex-start;gap:10px;
      padding:12px;
      border-radius:0;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04)
    }
    .consentBox input{width:auto;margin-top:2px}
    #submitStatus{display:inline-block;min-height:18px}
    .btn[disabled]{opacity:.6;cursor:not-allowed}

    /* --- Step bar (color + above the fold) --- */
    .stepbar{
      margin-top: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius: 0;
      overflow: hidden;
    }
    .stepbar .row{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
    @media (max-width: 860px){
      .stepbar .row{ grid-template-columns: 1fr; }
    }
    .step{
      padding: 10px 12px;
      border-right: 1px solid rgba(255,255,255,.10);
    }
    .step:last-child{ border-right:none; }
    .step .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:11px;
      font-weight:1000;
      letter-spacing:.08em;
      text-transform: uppercase;
      opacity:.95;
      margin-bottom: 6px;
    }
    .dot{
      width:10px;height:10px;border-radius:2px;
      background: rgba(43,108,255,.95);
      box-shadow: 0 0 0 2px rgba(43,108,255,.18);
    }
    .dot.red{ background: rgba(255,0,80,.95); box-shadow: 0 0 0 2px rgba(255,0,80,.18); }
    .dot.teal{ background: rgba(0,242,234,.95); box-shadow: 0 0 0 2px rgba(0,242,234,.18); }
    .step p{
      margin: 0;
      font-size: 12px;
      opacity: .88;
      line-height: 1.45;
    }

    /* --- Colored field headers --- */
    .fieldTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom: 6px;
    }
    .fieldTop .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 4px 8px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      font-size: 11px;
      font-weight: 1000;
      letter-spacing: .06em;
      text-transform: uppercase;
      opacity:.95;
    }
    .pill .miniDot{
      width:9px;height:9px;border-radius:2px;
      background: rgba(43,108,255,.95);
    }
    .pill.red .miniDot{ background: rgba(255,0,80,.95); }
    .pill.teal .miniDot{ background: rgba(0,242,234,.95); }

    /* Keep hero text readable but not bulky */
    .heroCopy{
      margin:0;
      color:rgba(233,238,248,.78);
      line-height:1.6;
      max-width: 95ch;
    }
    .heroCopy strong{ color:#e9eef8; }

    /* Make "Submit for review" clearly blue (also if .blue class differs elsewhere) */
    #submitBtn.btn.blue, #submitBtn.btn.primary{
      background: rgba(43,108,255,.95);
      border-color: rgba(0,0,0,.25);
      color: #fff;
    }
    #submitBtn.btn.blue:hover{ filter: brightness(1.06); }
  </style>
</head>

<body data-page="submit">
  <div id="siteHeader"></div>

  <main>
    <section class="hero" style="padding-bottom:10px">
      <div class="wrap">
        <h1 style="font-size:40px; margin:0 0 6px">Submit a Facebook Post</h1>

        <p class="heroCopy">
          Use this page to submit a <strong>Facebook post</strong> to Civic Threat for review and archiving.
          Choose whether it belongs in <strong>Support</strong> or <strong>MAGA / Debate</strong>, add a short headline,
          then paste the Facebook embed iframe (recommended) or the direct URL. Approved posts appear publicly after moderation.
        </p>

        <!-- Color step bar (compact, above the fold) -->
        <div class="stepbar" aria-label="How to submit a post">
          <div class="row">
            <div class="step">
              <div class="tag"><span class="dot teal"></span> Step 1 • Choose feed</div>
              <p>Select <strong>Facebook • Support</strong> or <strong>Facebook • MAGA / Debate</strong> so your post lands in the right place.</p>
            </div>
            <div class="step">
              <div class="tag"><span class="dot"></span> Step 2 • Write headline</div>
              <p>Add a short title people can search (creator name, topic like Trump/MAGA, tariffs, immigration, etc.).</p>
            </div>
            <div class="step">
              <div class="tag"><span class="dot red"></span> Step 3 • Paste embed</div>
              <p>Paste the Facebook <strong>Embed</strong> iframe or a direct post URL. Then click <strong>Submit for review</strong>.</p>
            </div>
          </div>
        </div>

        <div class="smallnote" style="margin-top:10px">
          Browse feeds: <a href="/facebook">Support</a> • <a href="/facebook-maga">MAGA / Debate</a> •
          Released files: <a href="/released/epstein/epstein-reader">Epstein reader</a>
        </div>
      </div>
    </section>

    <section class="section" style="padding-top:12px">
      <div class="wrap">
        <form id="submitForm" autocomplete="off">
          <div class="feed-grid" style="grid-template-columns: 1fr 1fr; gap:14px">
            <div>
              <div class="fieldTop">
                <label for="category" style="margin:0">Category</label>
                <span class="pill teal"><span class="miniDot"></span> Step 1</span>
              </div>
              <select id="category" required>
                <option value="support">Facebook • Support</option>
                <option value="maga">Facebook • MAGA / Debate</option>
              </select>
              <div class="smallnote" style="margin-top:6px">
                <strong>Support</strong> = creators/pages you support. <strong>MAGA / Debate</strong> = discussion, narrative tracking, and context-checking.
              </div>
            </div>

            <div>
              <div class="fieldTop">
                <label for="title" style="margin:0">Title (max 80 characters)</label>
                <span class="pill"><span class="miniDot"></span> Step 2</span>
              </div>
              <input id="title" maxlength="80" placeholder="Short, clear headline…" required/>
              <div class="smallnote" style="margin-top:6px">
                Good titles improve search and indexing. Example: “Trump tariff claim — fact check” or “MAGA rally clip — context”.
              </div>
            </div>
          </div>

          <div style="margin-top:14px">
            <div class="fieldTop">
              <label for="embed" style="margin:0">Facebook Embed Code (or direct post URL)</label>
              <span class="pill red"><span class="miniDot"></span> Step 3</span>
            </div>
            <textarea id="embed" placeholder='Paste the full embed snippet from Facebook… or paste a direct Facebook URL.' required></textarea>
            <div class="smallnote" style="margin-top:8px">
              Quick embed tip: Open the post → tap the three dots → <strong>Embed</strong> → copy the iframe code.
              If you only have a URL, paste the direct Facebook link.
            </div>
          </div>

          <div class="feed-grid" style="grid-template-columns: 1fr 1fr; gap:14px; margin-top:14px">
            <div>
              <label for="username">Your username (optional)</label>
              <input id="username" placeholder="Example: CivicThreat"/>
              <div class="smallnote" style="margin-top:6px">
                Don’t forget this if you want credit. With consent checked, your name shows as “Submitted by”.
                Without consent (or blank username), it shows as Anonymous.
              </div>
            </div>

            <div>
              <label>&nbsp;</label>
              <div class="consentBox">
                <input id="consent" type="checkbox"/>
                <div class="smallnote">
                  I agree my username may be displayed publicly on this site.
                  <br/>
                  <a href="https://chattokgaming.com/policy/privacy" target="_blank" rel="noopener">Privacy</a>
                  •
                  <a href="https://chattokgaming.com/policy/terms" target="_blank" rel="noopener">Terms</a>
                </div>
              </div>
            </div>
          </div>

          <div style="margin-top:16px; display:flex; gap:10px; align-items:center; flex-wrap:wrap">
            <button id="submitBtn" class="btn blue" type="submit">Submit for review</button>
            <span id="submitStatus" class="smallnote"></span>
          </div>
        </form>

        <div class="hr"></div>

        <div class="smallnote" style="max-width:95ch">
          Submissions are reviewed before appearing publicly. Please keep it civil — no hate speech, doxxing, or harassment.
          Civic Threat does not endorse wrongdoing and does not make claims about guilt or innocence; this site is for public-interest discussion and context review.
        </div>
      </div>
    </section>
  </main>

  <div id="siteFooter"></div>

  <!-- IMPORTANT: script order (cache-busted) -->
  <script src="/config.js?v=12"></script>
  <script src="/data-api.js?v=12"></script>
  <script src="/app.js?v=12"></script>

  <script>
    (function(){
      "use strict";

      const form = document.getElementById("submitForm");
      const statusEl = document.getElementById("submitStatus");
      const btn = document.getElementById("submitBtn");

      function setStatus(msg, ok){
        statusEl.textContent = msg || "";
        statusEl.style.color = ok ? "rgba(0,242,234,.95)" : "rgba(255,140,140,.95)";
      }

      function uuid(){
        if (window.crypto && crypto.randomUUID) return crypto.randomUUID();
        return "ct_" + Math.random().toString(36).slice(2) + Date.now().toString(36);
      }

      function extractFacebookUrl(raw){
        const s = (raw || "").trim();
        if (!s) return "";

        // direct URL
        if (/^https?:\/\/(www\.)?facebook\.com\//i.test(s) || /^https?:\/\/(www\.)?fb\.watch\//i.test(s)) return s;

        // find any facebook url in the blob
        const any = s.match(/https?:\/\/(www\.)?facebook\.com\/[^\s"'<>]+/i);
        if (any) return any[0];

        // common embed: plugins/post.php?href=<ENCODED_URL>
        const srcMatch = s.match(/src=["']([^"']+)["']/i);
        if (srcMatch && srcMatch[1]) {
          try {
            const u = new URL(srcMatch[1], location.origin);
            const href = u.searchParams.get("href");
            if (href) return decodeURIComponent(href);
          } catch(e){}
        }

        // sometimes raw contains encoded URL
        if (/facebook\.com%2F/i.test(s)) {
          try {
            const decoded = decodeURIComponent(s);
            const m = decoded.match(/https?:\/\/(www\.)?facebook\.com\/[^\s"'<>]+/i);
            if (m) return m[0];
          } catch(e){}
        }

        return "";
      }

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        if (!window.CT_CONFIG || !String(window.CT_CONFIG.API_URL || "").trim()) {
          setStatus("Config error: API_URL missing in config.js", false);
          return;
        }
        if (!window.CT_API || typeof window.CT_API.submit !== "function") {
          setStatus("Submit system not loaded. (data-api.js not ready)", false);
          return;
        }

        const category = document.getElementById("category").value;
        const title = document.getElementById("title").value.trim();
        const embed = document.getElementById("embed").value;
        const username = document.getElementById("username").value.trim();
        const consent = document.getElementById("consent").checked;

        const postUrl = extractFacebookUrl(embed);

        if (!title) { setStatus("Please add a title.", false); return; }
        if (!postUrl) { setStatus("Could not detect a Facebook URL. Paste a direct post URL or the full embed code.", false); return; }

        const item = {
          id: uuid(),
          platform: "facebook",
          category,
          title,
          postUrl,
          submittedAt: Date.now(),
          submitterName: (consent && username) ? username : "Anonymous",
          submitterLink: "",
          consent: !!(consent && username)
        };

        try {
          btn.disabled = true;
          btn.textContent = "Submitting…";
          setStatus("Submitting…", true);

          await window.CT_API.submit(item);

          setStatus("Submitted! Your submission has been added for review.", true);
          form.reset();
        } catch (err) {
          const msg = (err && err.message) ? err.message : String(err);
          setStatus("Submit failed: " + msg, false);
        } finally {
          btn.disabled = false;
          btn.textContent = "Submit for review";
        }
      });
    })();
  </script>
</body>
</html>
